{"version":3,"file":"client.js","sourceRoot":"","sources":["client.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Core Memory Client - Pure Browser-Safe Implementation\n *\n * NO Node.js dependencies, NO CLI code, NO child_process\n * Works in: Browser, React Native, Cloudflare Workers, Edge Functions, Deno, Bun\n *\n * Bundle size: ~15KB gzipped\n */\n\nimport type {\n  MemoryEntry,\n  MemoryTopic,\n  CreateMemoryRequest,\n  UpdateMemoryRequest,\n  SearchMemoryRequest,\n  CreateTopicRequest,\n  MemorySearchResult,\n  UserMemoryStats\n} from './types';\n\n/**\n * Configuration options for the Memory Client\n */\nexport interface CoreMemoryClientConfig {\n  /** API endpoint URL */\n  apiUrl: string;\n  /** API key for authentication */\n  apiKey?: string;\n  /** Bearer token for authentication (alternative to API key) */\n  authToken?: string;\n  /** Organization ID (optional - will be auto-resolved if not provided) */\n  organizationId?: string;\n  /** User ID (optional - used as fallback for organization ID) */\n  userId?: string;\n  /** Request timeout in milliseconds (default: 30000) */\n  timeout?: number;\n  /** Custom headers to include with requests */\n  headers?: Record<string, string>;\n\n  // Advanced options (all optional)\n  /** Retry configuration */\n  retry?: {\n    maxRetries?: number;\n    retryDelay?: number;\n    backoff?: 'linear' | 'exponential';\n  };\n  /** Cache configuration (browser only) */\n  cache?: {\n    enabled?: boolean;\n    ttl?: number;\n  };\n\n  // Hooks for custom behavior\n  /** Called when an error occurs */\n  onError?: (error: ApiError) => void;\n  /** Called before each request */\n  onRequest?: (endpoint: string) => void;\n  /** Called after each response */\n  onResponse?: (endpoint: string, duration: number) => void;\n}\n\n/**\n * Standard API response wrapper\n */\nexport interface ApiResponse<T> {\n  data?: T;\n  error?: string;\n  message?: string;\n}\n\n/**\n * API error with details\n */\nexport interface ApiError {\n  message: string;\n  code?: string;\n  statusCode?: number;\n  details?: unknown;\n}\n\n/**\n * Paginated response for list operations\n */\nexport interface PaginatedResponse<T> {\n  data: T[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    pages: number;\n  };\n}\n\n/**\n * Core Memory Client class for interacting with the Memory as a Service API\n *\n * This is a pure browser-safe client with zero Node.js dependencies.\n * It uses only standard web APIs (fetch, AbortController, etc.)\n */\nexport class CoreMemoryClient {\n  private config: Required<Omit<CoreMemoryClientConfig, 'apiKey' | 'authToken' | 'organizationId' | 'userId' | 'headers' | 'retry' | 'cache' | 'onError' | 'onRequest' | 'onResponse'>> &\n    Pick<CoreMemoryClientConfig, 'apiKey' | 'authToken' | 'organizationId' | 'userId' | 'headers' | 'retry' | 'cache' | 'onError' | 'onRequest' | 'onResponse'>;\n  private baseHeaders: Record<string, string>;\n\n  constructor(config: CoreMemoryClientConfig) {\n    this.config = {\n      timeout: 30000,\n      ...config\n    };\n\n    this.baseHeaders = {\n      'Content-Type': 'application/json',\n      'User-Agent': '@lanonasis/memory-client/2.0.0',\n      ...config.headers\n    };\n\n    // Set authentication headers\n    if (config.authToken) {\n      this.baseHeaders['Authorization'] = `Bearer ${config.authToken}`;\n    } else if (config.apiKey) {\n      this.baseHeaders['X-API-Key'] = config.apiKey;\n    }\n\n    // Add organization ID header if provided\n    if (config.organizationId) {\n      this.baseHeaders['X-Organization-ID'] = config.organizationId;\n    }\n  }\n\n  /**\n   * Enrich request body with organization context if configured\n   * This ensures the API has the organization_id even if not in auth token\n   */\n  private enrichWithOrgContext<T extends Record<string, unknown>>(body: T): T {\n    // If organizationId is configured, include it in the request body\n    if (this.config.organizationId && !body.organization_id) {\n      return {\n        ...body,\n        organization_id: this.config.organizationId\n      };\n    }\n    // Fallback to userId if no organizationId configured\n    if (!this.config.organizationId && this.config.userId && !body.organization_id) {\n      return {\n        ...body,\n        organization_id: this.config.userId\n      };\n    }\n    return body;\n  }\n\n  /**\n   * Make an HTTP request to the API\n   */\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<ApiResponse<T>> {\n    const startTime = Date.now();\n\n    // Call onRequest hook if provided\n    if (this.config.onRequest) {\n      try {\n        this.config.onRequest(endpoint);\n      } catch (error) {\n        console.warn('onRequest hook error:', error);\n      }\n    }\n\n    // Handle gateway vs direct API URL formatting\n    const baseUrl = this.config.apiUrl.includes('/api')\n      ? this.config.apiUrl.replace('/api', '')\n      : this.config.apiUrl;\n\n    const url = `${baseUrl}/api/v1${endpoint}`;\n\n    try {\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), this.config.timeout);\n\n      const response = await fetch(url, {\n        headers: { ...this.baseHeaders, ...options.headers },\n        signal: controller.signal,\n        ...options,\n      });\n\n      clearTimeout(timeoutId);\n\n      let data: T;\n      const contentType = response.headers.get('content-type');\n\n      if (contentType && contentType.includes('application/json')) {\n        data = await response.json() as T;\n      } else {\n        data = await response.text() as unknown as T;\n      }\n\n      if (!response.ok) {\n        const error: ApiError = {\n          message: (data as Record<string, unknown>)?.error as string || `HTTP ${response.status}: ${response.statusText}`,\n          statusCode: response.status,\n          code: 'API_ERROR'\n        };\n\n        // Call onError hook if provided\n        if (this.config.onError) {\n          try {\n            this.config.onError(error);\n          } catch (hookError) {\n            console.warn('onError hook error:', hookError);\n          }\n        }\n\n        return { error: error.message };\n      }\n\n      // Call onResponse hook if provided\n      if (this.config.onResponse) {\n        try {\n          const duration = Date.now() - startTime;\n          this.config.onResponse(endpoint, duration);\n        } catch (error) {\n          console.warn('onResponse hook error:', error);\n        }\n      }\n\n      return { data };\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        const timeoutError: ApiError = {\n          message: 'Request timeout',\n          code: 'TIMEOUT_ERROR',\n          statusCode: 408\n        };\n\n        if (this.config.onError) {\n          try {\n            this.config.onError(timeoutError);\n          } catch (hookError) {\n            console.warn('onError hook error:', hookError);\n          }\n        }\n\n        return { error: 'Request timeout' };\n      }\n\n      const networkError: ApiError = {\n        message: error instanceof Error ? error.message : 'Network error',\n        code: 'NETWORK_ERROR'\n      };\n\n      if (this.config.onError) {\n        try {\n          this.config.onError(networkError);\n        } catch (hookError) {\n          console.warn('onError hook error:', hookError);\n        }\n      }\n\n      return {\n        error: error instanceof Error ? error.message : 'Network error'\n      };\n    }\n  }\n\n  /**\n   * Test the API connection and authentication\n   */\n  async healthCheck(): Promise<ApiResponse<{ status: string; timestamp: string }>> {\n    return this.request('/health');\n  }\n\n  // Memory Operations\n\n  /**\n   * Create a new memory\n   */\n  async createMemory(memory: CreateMemoryRequest): Promise<ApiResponse<MemoryEntry>> {\n    const enrichedMemory = this.enrichWithOrgContext(memory as Record<string, unknown>);\n    return this.request<MemoryEntry>('/memory', {\n      method: 'POST',\n      body: JSON.stringify(enrichedMemory)\n    });\n  }\n\n  /**\n   * Get a memory by ID\n   */\n  async getMemory(id: string): Promise<ApiResponse<MemoryEntry>> {\n    return this.request<MemoryEntry>(`/memory/${encodeURIComponent(id)}`);\n  }\n\n  /**\n   * Update an existing memory\n   */\n  async updateMemory(id: string, updates: UpdateMemoryRequest): Promise<ApiResponse<MemoryEntry>> {\n    return this.request<MemoryEntry>(`/memory/${encodeURIComponent(id)}`, {\n      method: 'PUT',\n      body: JSON.stringify(updates)\n    });\n  }\n\n  /**\n   * Delete a memory\n   */\n  async deleteMemory(id: string): Promise<ApiResponse<void>> {\n    return this.request<void>(`/memory/${encodeURIComponent(id)}`, {\n      method: 'DELETE'\n    });\n  }\n\n  /**\n   * List memories with optional filtering and pagination\n   */\n  async listMemories(options: {\n    page?: number;\n    limit?: number;\n    memory_type?: string;\n    topic_id?: string;\n    project_ref?: string;\n    status?: string;\n    tags?: string[];\n    sort?: string;\n    order?: 'asc' | 'desc';\n  } = {}): Promise<ApiResponse<PaginatedResponse<MemoryEntry>>> {\n    const params = new URLSearchParams();\n\n    Object.entries(options).forEach(([key, value]) => {\n      if (value !== undefined && value !== null) {\n        if (Array.isArray(value)) {\n          params.append(key, value.join(','));\n        } else {\n          params.append(key, String(value));\n        }\n      }\n    });\n\n    const queryString = params.toString();\n    const endpoint = queryString ? `/memory?${queryString}` : '/memory';\n\n    return this.request<PaginatedResponse<MemoryEntry>>(endpoint);\n  }\n\n  /**\n   * Search memories using semantic search\n   */\n  async searchMemories(request: SearchMemoryRequest): Promise<ApiResponse<{\n    results: MemorySearchResult[];\n    total_results: number;\n    search_time_ms: number;\n  }>> {\n    const enrichedRequest = this.enrichWithOrgContext(request as Record<string, unknown>);\n    return this.request('/memory/search', {\n      method: 'POST',\n      body: JSON.stringify(enrichedRequest)\n    });\n  }\n\n  /**\n   * Bulk delete multiple memories\n   */\n  async bulkDeleteMemories(memoryIds: string[]): Promise<ApiResponse<{\n    deleted_count: number;\n    failed_ids: string[];\n  }>> {\n    const enrichedRequest = this.enrichWithOrgContext({ memory_ids: memoryIds });\n    return this.request('/memory/bulk/delete', {\n      method: 'POST',\n      body: JSON.stringify(enrichedRequest)\n    });\n  }\n\n  // Topic Operations\n\n  /**\n   * Create a new topic\n   */\n  async createTopic(topic: CreateTopicRequest): Promise<ApiResponse<MemoryTopic>> {\n    const enrichedTopic = this.enrichWithOrgContext(topic as Record<string, unknown>);\n    return this.request<MemoryTopic>('/topics', {\n      method: 'POST',\n      body: JSON.stringify(enrichedTopic)\n    });\n  }\n\n  /**\n   * Get all topics\n   */\n  async getTopics(): Promise<ApiResponse<MemoryTopic[]>> {\n    return this.request<MemoryTopic[]>('/topics');\n  }\n\n  /**\n   * Get a topic by ID\n   */\n  async getTopic(id: string): Promise<ApiResponse<MemoryTopic>> {\n    return this.request<MemoryTopic>(`/topics/${encodeURIComponent(id)}`);\n  }\n\n  /**\n   * Update a topic\n   */\n  async updateTopic(id: string, updates: Partial<CreateTopicRequest>): Promise<ApiResponse<MemoryTopic>> {\n    return this.request<MemoryTopic>(`/topics/${encodeURIComponent(id)}`, {\n      method: 'PUT',\n      body: JSON.stringify(updates)\n    });\n  }\n\n  /**\n   * Delete a topic\n   */\n  async deleteTopic(id: string): Promise<ApiResponse<void>> {\n    return this.request<void>(`/topics/${encodeURIComponent(id)}`, {\n      method: 'DELETE'\n    });\n  }\n\n  /**\n   * Get user memory statistics\n   */\n  async getMemoryStats(): Promise<ApiResponse<UserMemoryStats>> {\n    return this.request<UserMemoryStats>('/memory/stats');\n  }\n\n  // Utility Methods\n\n  /**\n   * Update authentication token\n   */\n  setAuthToken(token: string): void {\n    this.baseHeaders['Authorization'] = `Bearer ${token}`;\n    delete this.baseHeaders['X-API-Key'];\n  }\n\n  /**\n   * Update API key\n   */\n  setApiKey(apiKey: string): void {\n    this.baseHeaders['X-API-Key'] = apiKey;\n    delete this.baseHeaders['Authorization'];\n  }\n\n  /**\n   * Clear authentication\n   */\n  clearAuth(): void {\n    delete this.baseHeaders['Authorization'];\n    delete this.baseHeaders['X-API-Key'];\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(updates: Partial<CoreMemoryClientConfig>): void {\n    this.config = { ...this.config, ...updates };\n\n    if (updates.headers) {\n      this.baseHeaders = { ...this.baseHeaders, ...updates.headers };\n    }\n  }\n\n  /**\n   * Get current configuration (excluding sensitive data)\n   */\n  getConfig(): Omit<CoreMemoryClientConfig, 'apiKey' | 'authToken'> {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const { apiKey, authToken, ...safeConfig } = this.config;\n    return safeConfig;\n  }\n}\n\n/**\n * Factory function to create a new Core Memory Client instance\n */\nexport function createMemoryClient(config: CoreMemoryClientConfig): CoreMemoryClient {\n  return new CoreMemoryClient(config);\n}\n"]}